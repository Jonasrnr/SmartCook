{% extends "recipes/base.html" %} {% load static %} {% block title %} Edit {{ recipe.title }} {% endblock %} {% block content %}
<div class="max-w-5xl mx-auto p-6 space-y-6">
    {% csrf_token %}

    <!-- Recipe Header with image -->
    <div class="flex flex-col sm:flex-row items-center bg-white rounded-xl shadow-md p-4 gap-6">
        <a href="{{ recipe.url }}" target="_blank" rel="noopener noreferrer">
            <img src="{{ recipe.thumbnail|default:'https://placehold.co/300x200/2563EB/ffffff?text=Rezept+Bild' }}" alt="{{ recipe.title }}" class="w-full sm:w-48 h-32 object-cover rounded-xl shadow-md">
        </a>
        <div class="flex-1">
            <h1 class="text-3xl font-bold text-gray-800">{{ recipe.title }}</h1>
            <p class="text-gray-500 mt-2">{{ recipe.description }}</p>
            <p class="text-gray-500 mt-1 text-sm">Vorbereitung: {{ recipe.prep_time }} | Kochzeit: {{ recipe.cook_time }} | Portionen: {{ recipe.servings }}</p>
        </div>
    </div>


    <div class="flex gap-6">

        <!-- Ingredients -->
        <section class="flex-1">
            <div class="flex justify-between items-center mb-2">
                <h2 class="text-2xl font-bold flex items-center gap-2">ðŸ§‚ Zutaten</h2>
                <button id="add-ingredient-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-3 rounded-lg text-sm">+</button>
            </div>
            {{ ingredient_formset.management_form }}

            <div class="flex gap-2 font-bold underline text-black mb-1">
                <span class="w-32">Name</span>
                <span class="w-20">Menge</span>
                <span class="w-20">Einheit</span>
            </div>

            <ul id="ingredient-list" class="space-y-1 text-black list-disc list-inside">
                {% for form in ingredient_formset %} {% if form.instance.name or form.instance.quantity or form.instance.unit %}
                <li class="flex gap-2 items-center" data-ingredient-id="{{ form.instance.id }}">
                    <input type="text" value="{{ form.instance.name|default_if_none:'' }}" data-id="{{ form.instance.id }}" data-field="name" data-type="ingredient" class="auto-save-input border rounded px-2 py-1 w-32" placeholder="">
                    <input type="text" value="{{ form.instance.quantity|default_if_none:'' }}" data-id="{{ form.instance.id }}" data-field="quantity" data-type="ingredient" class="auto-save-input border rounded px-2 py-1 w-20" placeholder="" inputmode="numeric" pattern="[0-9]*">
                    <input type="text" value="{{ form.instance.unit|default_if_none:'' }}" data-id="{{ form.instance.id }}" data-field="unit" data-type="ingredient" class="auto-save-input border rounded px-2 py-1 w-20" placeholder="">
                </li>
                {% endif %} {% endfor %}
            </ul>
        </section>

        <div class="w-px bg-gray-300"></div>

        <!-- Instructions -->
        <section class="flex-1">
            <div class="flex justify-between items-center mb-2">
                <h2 class="text-xl font-bold flex items-center gap-2">ðŸ“‹ Schritte</h2>
                <button id="add-instruction-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-3 rounded-lg text-sm">+</button>
            </div>
            {{ instruction_formset.management_form }}
            <div id="instruction-list" class="rounded-xl shadow-2xl bg-white p-2">
                {% for form in instruction_formset %} {% if form.instance.description %}
                <div class="bg-white p-3 flex gap-2 items-start" data-instruction-id="{{ form.instance.id }}">
                    <span class="font-bold text-3xl mt-1 step-number" data-step="{{ form.instance.step_number }}"></span>
                    <textarea data-id="{{ form.instance.id }}" data-field="description" data-type="instruction" class="overflow-y-auto resize-none auto-save-input shadow-xl rounded px-2 py-1 w-full" placeholder="Schritt Beschreibung">{{ form.instance.description|default_if_none:'' }}
                  </textarea>
                </div>
                {% endif %} {% endfor %}
            </div>
        </section>
    </div>
</div>

{% endblock %} {% block scripts %} {{ recipe.id|json_script:"recipe-id" }}
<script src="{% static 'js/edit_recipe.js' %}"></script>
{% endblock %}